# SAMPLE CLOUD

## Описание

SAMPLE CLOUD - это платформа для использования и создания библиотек с сэмплами. Платформа является источником для творчества музыкантов, саундпродюссеров, битмейкеров, звукоинженеров, а также просто любителей музыки. Пакеты с семплами созданы в самых разнообразных жанрах: от хип-хопа, хауса, техно, кинематографии до любых стилей между ними.

### `REGISTRATION`

![регистрация](https://s547sas.storage.yandex.net/rdisk/24cd2257412b3122e4fd194f18073baacb2dc2ea6358d217314ba80f1d3700c1/61f874e0/84radWxDYTwZNdBUTS9Gwm5YtaksMdNYB2LqgeLQ48xXTe02IQ8ugAbuAKZ7mNXy2WFadJauxbF5J0bmGkQxZA==?uid=964945203&filename=registration.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=2610580&hid=718f88ac7c6a7e115edc8dbe6c191628&media_type=image&tknv=v2&etag=f5af280a275906033d8ceea721b2c9ad&rtoken=3s31GYaA2Gne&force_default=yes&ycrid=na-31280daf36b82b74ad31523bac9e3905-downloader21h&ts=5d6e9655ef800&s=a76043bb09c7b1dd81e14c8568c5f6abc0be8fbbddbceab93d8d0a7ca9999c89&pb=U2FsdGVkX1_c3MxX0vxNptgBV1AWcUkM7pWPQP22TnHZ6bXDApsnxR2Xekc4Csxes3q1Vuespxzwpmtcrp06MQNlso12YMQRdiDgg5_f5nM)

### `LOGIN`

Вход в приложение по email и паролю:

![авторизация](https://s444man.storage.yandex.net/rdisk/77402d4c2a3bc1b1607584b4bd8a829d268fb7b6b3c4cc35d2852e777bc8e6cf/61f874f5/84radWxDYTwZNdBUTS9Gwo386p5AwN81cesNrjneiyFlweQtn2byrsTzwup8KG7IN-OQjseLOGjCx2rr5I3Dcw==?uid=964945203&filename=login.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=2642379&hid=134db666ecdd698903684ddadf9505ac&media_type=image&tknv=v2&etag=c3a22209a21b32803231c42fc0ad41d3&rtoken=nP7stOC8RLt9&force_default=yes&ycrid=na-a60593b1a2fbda1c1f9ef39769d64fc3-downloader10f&ts=5d6e9669f6740&s=b6c88cc77d14a48452c347a9a9290154bfd94c70b79c25909329ed769dc9d237&pb=U2FsdGVkX1_GXMRqk4kOvQopg7L2FhfU7GSTpNSCcuGj4gv80TK4S2_SqnmCEWAh475-83Ap7WhfW6v0EJYAoiIlXhl3FdJuFdrbqj1C_x4)

### `MAIN PAGE`

При удачной авторизации мы попадаем на главную страницу платформы. Здесь можно найти и прослушать демо библиотек с семплами(Packs).

<br/>

![main-page](https://s125vla.storage.yandex.net/rdisk/9948e3fd974846b74620d615c4b072eb915331cfe9cd0904383acff985d8a90f/61f87520/84radWxDYTwZNdBUTS9Gwnpe2aIHG5ZaQPI5UcaNsFv2nFvNeJ3tzMh30cwtHjF9He-olfNwM_qFh2GuILzgRQ==?uid=964945203&filename=main-page.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=3743343&hid=be66a8418e61d19090ce29c1d3b621f8&media_type=image&tknv=v2&etag=e58f8fdbe9d002e8215456b25bb91120&rtoken=i06QtIdemBzu&force_default=yes&ycrid=na-64c2d214fbf1fa4c9fdc6de2d5563593-downloader10f&ts=5d6e9692f8800&s=cd7a9c8b7b723d59cef35c69d44894184c9a407d46359556b3005ae61b7451db&pb=U2FsdGVkX186W3iZ34aCyguL5OeVSoFwwtAl4Y3u4p6v0aYfWY0pTDbxicZkjOU135esjCX2tDlnu_tiduDy65bRSH1MXrEmNyB6uv3iUUY)

<br/>

`Поиск осуществляется по жанрам, а также авторам библиотек.`

![search](https://s616sas.storage.yandex.net/rdisk/146bffdb02bccbe9abcc58baed0b5ee169d1ac54ec3e1a489f654e06bfafa7c0/61f87537/84radWxDYTwZNdBUTS9GwnjLRxzkpf42AjXnz_AfuZ9RUp0JqnydEaoQZfSO2PQ79SYlHL3CPGNti2cwWnOrUw==?uid=964945203&filename=search.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=21118&hid=96b4f792381e1b194d9dc059a0f738e8&media_type=image&tknv=v2&etag=761da31a89622c27dee33902f9af607c&rtoken=E8rYQRN7QIIk&force_default=yes&ycrid=na-66df9bf46290db6e29aa675c45e5ed69-downloader21h&ts=5d6e96a8e7bc0&s=b6e126e11f94b26acc1437c100df0e069b05c733cb2fb9aa56fba988c818cfca&pb=U2FsdGVkX1-Qq_bytQB-bKueQ3aS8xcH5-GYnikduo48Tud5yHTlN9gc3EZ-3vdyLxpQ2RITC6-2vWW1lC2u7l0LBTOPZ2qsxsLsdVPVfcI)

`При нажатии на иконку play открывается плеер и включается проигрывание демо библиотеки.`

![player](https://s108vla.storage.yandex.net/rdisk/26f85c579965472c668305f1a8dd91b0efe410b95b9e39feb57304267184afde/61f87554/84radWxDYTwZNdBUTS9GwogcZw1LvVA5ENGp3jwbkPVaRNbmV4UQ_LMXJhffQOJ4cypVnSzuLpHCYEyWCM70rg==?uid=964945203&filename=player.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=3514253&hid=2773de6345b5e8d5d0f0d6989d4a63fa&media_type=image&tknv=v2&etag=8728f4fa04cbfe07d2c59098a758869d&rtoken=Pidgyc88PQvv&force_default=yes&ycrid=na-2fc57e2b8e4dc5d2e647c58ef8aebe72-downloader21h&ts=5d6e96c48fd00&s=a88abaa314b65e4f1eda7d972192f72c64156cacd15905be4e8ad40ec5e13083&pb=U2FsdGVkX19MShT7U7vmuIc-wveWNiMPpGkjRHE3EqnKCKbUyvprv3HSdLhvOLzyPX5n6EkulLQkDv37d7AIlaauGFbdpioFvrWrVB18i4k)

### `PACK PROFILE PAGE`

`Выбрав библиотеку на странице main page открываем профайл с семплами.`

![sample-page](https://s233vla.storage.yandex.net/rdisk/9bc25638f38444d1da3e59ea1c0008d84f71a60a7133794912aae8bc39fe50e3/61f877f7/84radWxDYTwZNdBUTS9GwrZo0itGhUMzSPJVMv6WROGLypyIAmIBvBsXtEdSfXRU0eg6pFsm6RBAfvDMqWEaGg==?uid=964945203&filename=sample-page.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=1488373&hid=4c0355fb66bb7e823e79ae7b87e5c9da&media_type=image&tknv=v2&etag=298c7cd1578e86fc9089f48344d3028c&rtoken=1ueHa6kq9L0T&force_default=yes&ycrid=na-99e696eeff4494de1c0b64736266343c-downloader10f&ts=5d6e99484abc0&s=85f364993fdc7b571da42adfe7b9f830f43842febae6a94c4d02f92980303a0f&pb=U2FsdGVkX1-BoJUBY7xg0gqSnkhmuribC-3c_SVX9oASB4ENBsDFxVmxz6P5wHXBHpqmw1Btf72uj_k8G6H6Q8ESlYePaywy_PxcdPYNL_o)

`Категорию семплов можно фильтровать по тегам`

`При наведении на семпл появляется возможность прослушать его, а также перемотать в нужное место при проигровании.`

[demo](https://disk.yandex.ru/i/OJFzGtyJR7_Pkw)

Добавить категорию семпла, а также его bpm можно в модальном окне, которое открывается при нажатии на крайний правый вертикальный эллипсис семпла:

![category-bpm-modal](https://s399vla.storage.yandex.net/rdisk/d9dcc053e8a4c5ebdcc493d2741ac260334543c43f63aa05527692525b91a9b6/61f9695d/84radWxDYTwZNdBUTS9Gwi0tNRkakP7YCz4MqDtvPZNObImvkH-7N3MOWqplM4KfxMdw1jTHn9ziUq5OQXG3tQ==?uid=964945203&filename=category-bpm-modal.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=777306&hid=6b49cb4cd0260fc0d359ea4c78cbc33e&media_type=image&tknv=v2&etag=c7197f8f79d7d528e1559f9bc0919ae0&rtoken=G6LgFXbwiDxB&force_default=yes&ycrid=na-dd840cd591d0d1cc43ad19f191cefb7e-downloader19e&ts=5d6f7f7f75140&s=77bd6d8a7fb0238d766aa72cd954c1fbc5436a48fdcd4e27c1fc8ef90bd37ea1&pb=U2FsdGVkX1__pf13r5Ba8WoD6pW_HaefTbCsQHhV5Gu8j7ICjg2vQQeHhzet8pnreRfevNSFqWIDxI34Wi8k3-i5oIy36t6OWVBLoCkSQ1U)

### `PROFILE`

Страница для редактирования профайла пользователя.

![profile](https://s168vla.storage.yandex.net/rdisk/fa646a8c425ede50dda6ba012b7bfdbc17ca8924b9bca21c37cde16456aff790/61f87582/84radWxDYTwZNdBUTS9Gwrc5bzsMh1RUX0D7pBJkY9x1_0SDfaYZTBJsw8SSh-JGGrKaZQK0nrUzXC5QUhhlxw==?uid=964945203&filename=profile.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=170195&hid=2478e70a852a6684ebaa077ffc0b5d0d&media_type=image&tknv=v2&etag=63ea1e95d76e617dbc94c7e86d9f5e86&rtoken=9WTowR3HdBJq&force_default=yes&ycrid=na-eff05497ef60d2d7b8d4e90bef8c9559-downloader10f&ts=5d6e96f06e480&s=75283fa12c4ffff5292e44eb58fdbeb9d44d1c3d9ee55e3e96c6ea1700eaf6f0&pb=U2FsdGVkX1-4KG3IWamHMwD_-VWr9JOO2cMJIjuJRa4iRVvjiQiKaCEUUtSP7CrQyce32J8VW5-A_ULssnXbeWYQlRqeoGVw0YCJkPT24aE)

<br/>

2. `Нажав на аватар, попадаем на страницу редактирования аватара.`

![avatar](https://s98vla.storage.yandex.net/rdisk/de3857f02ea31ffe4306ae3e4d8c0371fb23f265548c4ea0a23bc794efd6d46f/61f87599/84radWxDYTwZNdBUTS9GwsEDYtx9-vKwJSYM2gX-WDesojsJ1vD1SYQw-ronKIh2Chee6SJ82S8kFeQlRoxzFQ==?uid=964945203&filename=avatar.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=23641&hid=5aab16259847b3bfc81086612a274371&media_type=image&tknv=v2&etag=2ce7bf242ce5dd390a90537956f31453&rtoken=ILenaycExwn2&force_default=yes&ycrid=na-68e037155212e82448be2e6a800681c8-downloader10f&ts=5d6e97065d840&s=2bdf1abafb4c81796331c640821993500afe77df4b184b153d3d608332b8815c&pb=U2FsdGVkX18XYGcAehKldss61VcaD5cZXro1z3FHaPLZf5lwJ8wFZPiVp2Bfzg2vkBQ-srfB0i0Lf80msWpPq5mLUvPNJ9CO48szmZtoCpI)
<br/>

![avatar-pointer](https://s255vla.storage.yandex.net/rdisk/690222a232b8e319615fd339946dbe9c884094ee7064a63464f761ae2e91553b/61f875b6/84radWxDYTwZNdBUTS9GwhifH0TEsarkheWfub1vfb9C9QULmSsRidN9Bt4aQPUGpEQXu4hXIL8a9mL1CeFtJQ==?uid=964945203&filename=avatar-pointer.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=143093&hid=732a5b3805ada6d91581d527a3b67081&media_type=image&tknv=v2&etag=d127059df35d6d8abc3eba282aec7bd6&rtoken=KM9N9rVwlOzS&force_default=yes&ycrid=na-0d6eb1641f0de82efdf72c9e1651d199-downloader10f&ts=5d6e972205980&s=9c9ddfd9f89968efb046d14109581432b362d2b8da7ecb1271d073fc69a387b0&pb=U2FsdGVkX19eYuAhOtSIIk3nhIw6I7UadH5SRkyKm_vKb72Z_KPcgG95trOwEdWpVszoy8bs6G9iC1HbsYE3OaI8RRO3aTkfN3gU4jD6c0E)

`Все, что нам нужно, это сделать дроп изображения. В результате получаем возможность вырезать нужный фрагмент из фото и сохранить результат.`

![avatar-editor](https://s685man.storage.yandex.net/rdisk/0b8e284c7d90dd7f524b0f63ae62baf5d90a916d6f673e5949cafb94bde8f9fa/61f875eb/84radWxDYTwZNdBUTS9GwqJgEMcoztCFfUb4Bl8Z4lcUnQw2cNgNKMiwg9dSUuDP-6wO_q_9zrtnogU0XbA8aQ==?uid=964945203&filename=avatar-editor.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=1247252&hid=7ba905c36a5b1409ca288de308d6b6a5&media_type=image&tknv=v2&etag=a0cb49c39515585cfdbd200daac54035&rtoken=I8kmtUT0wiF8&force_default=yes&ycrid=na-262b2d5933f9a24c191a09bad19e5f73-downloader10f&ts=5d6e9754910c0&s=6fa512d80217fd6f4b140d012039a7c56c82578a68872688dac9211db59ca852&pb=U2FsdGVkX19c4gyQTCa6Fi3t-XflEduTislB876phKfjA_vfxVJaSdKgndoFo5dVM2CGadNZrFlDSu9CabFSYlhG6xlB4lc5qb8-Zk6MywQ)

3. `Следующий блок предназначен для редактирования почты и инициалов пользователя.`

![update-username](https://s553man.storage.yandex.net/rdisk/39c12055ad52f730bc91a197e0a8674e7a606a95374eb3098d2af6469445ce6c/61f87601/84radWxDYTwZNdBUTS9Gwnub9bKeOEsF1SpnN1R0BRml4VA92ntIhIc9_rdVyNk7es2XvgQfj0M5hqwEEvAWFg==?uid=964945203&filename=update-username.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=58000&hid=edc5798914141ec996dbaac74cda8202&media_type=image&tknv=v2&etag=72db6b7263d990d9b292c0ef112d5238&rtoken=VxEkS76tO3hV&force_default=yes&ycrid=na-b057a2157c3f49f5bf8ff618e700cfaf-downloader10f&ts=5d6e97698c240&s=523ce231f1d625c317d264d8436f93417bd2f66df727bfa131af1b5d0b4b323b&pb=U2FsdGVkX18ZtLFlpKt_WK0JQRm773EwQt1JvY8-emBpTiwq_Z2rXyh1BwPw1OCEz0mbAYpnBz6UonISlgLj2iBlb6mIYJqob4ifZ1AdFCg)

<br/>

4. `Создание библиотеки(Pack).`

- Заполняем форму(pack information).

![create-pack-info](https://s809sas.storage.yandex.net/rdisk/9a5658347c6c7f050c66c1567c39aa5ed0d0374a12939867a1620a8a3d676b99/61f8761c/84radWxDYTwZNdBUTS9Gwnd4QZc_T-e8Vj7GwBkVlOQ-mfFANHTVy2Myq6uQVz3qpKnlWwfCbvaqlS0GgAkveA==?uid=964945203&filename=create-pack-info.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=132812&hid=7a2e755212c397edf5bf3801ea4c5dc6&media_type=image&tknv=v2&etag=45bbbc29c032df92378ccad0f9643445&rtoken=KBBQMLbVB4r3&force_default=yes&ycrid=na-c834039e3342b608d6b764223fcabff5-downloader10f&ts=5d6e97834bf00&s=97a38cc490c4ace42c627aa17a89057df811f559fc6bfd780b1eea289b8caba7&pb=U2FsdGVkX18Qbsh27taCrUzgNZXaGBpgDd9PBuLtp6_bvzH-L88L_UjcRz0chpgvkmzegMga--SyWbzlzSuWRZ5N7hJWzZof8XTjb3ZdhS4)

<br/>

- Загружаем обложку для библиотеки.

![pack-upload-image](https://s239vla.storage.yandex.net/rdisk/84d5e0ba3fb1e772116407daa049c322d6075149feb10654420a8e626174ffe9/61f8763f/84radWxDYTwZNdBUTS9GwjFitqDQRoTr17kr1WJpmMsnMOScFCiJqlkksFSBC0hZmrWpUUqWfbGCNRA-O5vr-g==?uid=964945203&filename=pack-upload-image.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=54863&hid=24b06496679285e3c6532830844b5405&media_type=image&tknv=v2&etag=6b4d40a6b5a925c1ae5cac03427e9cbb&rtoken=TsRRT6BkyctG&force_default=yes&ycrid=na-b2c085403010cd18f4e77ca402a35428-downloader10f&ts=5d6e97a4acdc0&s=b0bb0efabe68518f0ccabef23c41bde53690edfa3994b25aa6c488da3730daea&pb=U2FsdGVkX1_vtjL2LEW0edz_8HtUdb1PruBjan8MypTU-es7SG0SBIqFFS738Gl6eKgC6Nz95JVTNkgRok2RNJ9rCBew2ASoT4_CfxjuJqs)

<br/>

- Загружаем аудио для библиотеки.

![pack-audio-upload](https://s783sas.storage.yandex.net/rdisk/6bc58ec7c88e340d27f6416030f0f2be1295cbec460f3d27683d8527001d049c/61f8765d/84radWxDYTwZNdBUTS9GwnNiuMruwlC4rL5-AwQKc92ywuAvB1ZC0PKadupX3KZEshaZl4K75VYlc_XkUA1PLQ==?uid=964945203&filename=pack-audio-upload.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=53668&hid=eae9d6f3f823fc77043d457b50178d3e&media_type=image&tknv=v2&etag=e0867772e99b6821c38af3f51f00b8eb&rtoken=3MmYKjVH8NDm&force_default=yes&ycrid=na-573ef9ab030b6018b56ad66360fe72a5-downloader10f&ts=5d6e97c149140&s=1d1edc3dfd42317452b718c9331878750479329a38c89106d2f45f096265ac50&pb=U2FsdGVkX199nXGy20eOJE8Jww3_s9ZZwkHMUi4yOTzWyVKG8VieXv5ac79VK9cVNdy0xwuucHPg10z35SySTtkH3KWhx2Fr64WWv9clRdg)

`Далее попадаем на страницу библиотек(Packs), созданных пользователем(см.загрузка семплов в библиотеку(PACK)).`

5. `Загрузка семплов в библиотеку(PACK).`

Для загрузки семплов в библиотеку заходим на странницу `PROFILE`

![profile-pointer](https://s168vla.storage.yandex.net/rdisk/904bfa81170c00dc786f58905f445213dead30ed4b7c511f8ce40dbcd7ddf0b0/61f85c3e/84radWxDYTwZNdBUTS9Gwrc5bzsMh1RUX0D7pBJkY9x1_0SDfaYZTBJsw8SSh-JGGrKaZQK0nrUzXC5QUhhlxw==?uid=964945203&filename=profile.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=170195&hid=2478e70a852a6684ebaa077ffc0b5d0d&media_type=image&tknv=v2&etag=63ea1e95d76e617dbc94c7e86d9f5e86&rtoken=k4PcVPa3eMwQ&force_default=yes&ycrid=na-7b69fe3e29f7bcadb4db52d545b5941a-downloader19e&ts=5d6e7ed810b80&s=81054109e5fbdbe25a7cd66b80c02015b5ce2f2373caf1a200c7b63127623bd9&pb=U2FsdGVkX1_EsD80eSMK7JW4-pnrLBP7CjOqcHbeM8l8GOAB1gIrWdaaLzPmtAmlXKSsaXsG9Q2DkvgSLKtsGdmgvKPTSRFpW_-olCY1bVA)

<br/>

`далее выбираем раздел Packs`

<br/>

![packs-pointer](https://s190vla.storage.yandex.net/rdisk/f73c94a022c847e7cf9c6926c238582c7b3b53d1d7e0c6dfb763c21e41b83caf/61f85c65/84radWxDYTwZNdBUTS9Gwhck3wE7BEP54zzCFhJfTVCG-4xkLFSz3lYIeZAFrs6Ob1bMCfKK4DmrbFKpcu96sQ==?uid=964945203&filename=packs-pointer.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=16887&hid=6fe7df9102c7b648ffa8022bb3983050&media_type=image&tknv=v2&etag=ae30b9c5cb9bda9345460f67025cd836&rtoken=VgjuIrAOcK9F&force_default=yes&ycrid=na-cdbb59a5d182ad4e87d7df3a47951ee3-downloader19e&ts=5d6e7efd42340&s=951773744f9a6aaf0a862c4fccd437ff60e978e9835a648f1984f9c1e6801355&pb=U2FsdGVkX1-hjemj8raSCtvfuDStxpGV9viEZjWlACzmkrWyDlydpsOgeDRTkR7LYhsKIFZ97pu8RJlpitiLPAR20NcfEy7gokdreuPBkw0)

Пользователь попадает на страницу созданных им библиотек(Packs). Здесь можно добавлять семплы просто дропнув их в соответствующую библиотеку.

![drop-samples](https://s700sas.storage.yandex.net/rdisk/c09ec37a1d237e62ea9fef2fa5622b563d7e6715cd21a7f517e3154621c41cb2/61f942a8/84radWxDYTwZNdBUTS9Gwrysb5Us2pgVdluKsvRLEIb9BQoXGctJNA1cq1PmS0gy9ANxG6Grq8LOBwuZSTnPwQ==?uid=964945203&filename=drop-samples.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=2538428&hid=5d7004bf74f1dc21321a7bee6f2fd618&media_type=image&tknv=v2&etag=41b6c5d840408caaa1c490cf45f65740&rtoken=mC7F3kHoKFEp&force_default=yes&ycrid=na-6cd55d309c2d7e6461a929cc8acba53e-downloader2f&ts=5d6f5a957fa00&s=6b0e0788a27247283809dc5381a2a4b7dfd18d0bbe9a0121a45f40c4a341f430&pb=U2FsdGVkX1_vf_4JNbVYkvhL6BqT0pRF1BE8T5d8Y-Wo1iuhLduU4zqa2QRZUSvzm9hzYHi_p16vxOZ_xufKSoCIIlhFl3_P--wswbDxRAU)

На этом этапе я позволю себе более детально описать решения по оптимизации данного процесса.

1. `Получение, фильтрация и нормализация данных из загруженных пользователем файлов.`
   Когда пользователь загружает семплы в пакет(библиотеку семплов),

    ![drop-samples](https://s53iva.storage.yandex.net/rdisk/e897d423477f4b90e378d7c38d3ac94f71fd7bb1f9ef474ba7885e3716d96b89/61f87820/84radWxDYTwZNdBUTS9GwgHz7qhoP39-WwjBrNqeskcyaOPq-OykMy98P8Ftyfp6Gs5YogJ-406cbIU4LcKUxg==?uid=964945203&filename=%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202022-01-30%20%D0%B2%2016.24.31.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=49990&hid=6d77c536a817069769d88c1b0678130d&media_type=image&tknv=v2&etag=cad38ed2d6636d6f40d9cc051236fb37&rtoken=hONtlGrov0PI&force_default=yes&ycrid=na-cab4fc5db61b405291497c7a9232f72e-downloader10f&ts=5d6e996f64800&s=7160ec414be0e8be9cadea923a171b9349487b0c62da04d25c68d58820a37cc7&pb=U2FsdGVkX1-Ftb6RCaFcIzjGPL4zYu6SNQxseCC4BAP-WfFtvfY5odh7pCjJuYyWAAWpPtw_RgguedikS1qL0q0y4GY_FO7bS245y8XgD98)
    мы получаем массив аудио файлов. От каждого из этих файлов нам нужно получить массив координат для отрисовки визуальной части аудио трека.

    <br/>

    К счастью, браузер предоставляет возможность получить такие данные при помощи Web Audio API. Мы получаем, так называемый, AudioBuffer(массив данных по аудио файлу).

    ![array-buffer](https://s215vla.storage.yandex.net/rdisk/f3c411dea49c6110a5bb791f517105e1d12eec9d4732094a32c33ba15bf03840/61f87865/84radWxDYTwZNdBUTS9GwnpfUXWxEBhyl8vesRbrRxHpJAmYtJIRIOD_5HLeqkhYsMUvjhrtr8iaQBy6tcC5Pw==?uid=964945203&filename=%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202022-01-30%20%D0%B2%2017.31.18.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=299167&hid=873849b3e81603589d4bfd02ac1450db&media_type=image&tknv=v2&etag=cfad693d0755ad7cc1846d9240486f90&rtoken=36PVkOeNfHZT&force_default=yes&ycrid=na-0f16211d3586f72d4631f1872f2d1405-downloader10f&ts=5d6e99b132340&s=482bbc3b56d9a0a198f405b2411ad33ba32fb5c34161772f50e21e06760320d2&pb=U2FsdGVkX196Cgdc7E2Xoc-q-7e397YYRYy7UdGrUF_4DlQFEXFtbcrVfpDo-0b1iRV_iSVLso44viZkWRs7zb-KXppo1BxdEoUGgM6KHXo)
    Далее нам нужно оптимизировать этот большой миллионный массив чисел перед отрисовкой визуализации наших аудио.

    <br/>

    Алгоритм фильтрации разделяет данные на 550 равных частей и вычисляет среднее значение выборок, а также убирает отрицательные числа. В итоге вместо миллионого массива данных мы получаем массив из 550 чисел.

    ```javascript
    private filterData(audioBuffer: AudioBuffer) {
		const rawData = audioBuffer.getChannelData(0);
		const samples: number = 550;
		const blockSize: number = Math.floor(rawData.length / samples);
		const filteredData: number[] = [];

		for (let i = 0; i < samples; i++) {
			let blockStart = blockSize * i;

			let sum = 0;
			for (let j = 0; j < blockSize; j++) {
				sum = sum + Math.abs(rawData[blockStart + j]);
			}
			filteredData.push(sum / blockSize);
		}
		return filteredData;
	}
    ```
    `Остается сделать нормализацию данных`. В массиве 550 дробных чисел от 0 до 1. Наш canvas имеет высоту 50 пикселей. Соответственно изменияем масштаб данных в промежутке от 1 до 50ти и округляем дробные числа. В результате мы имеем массив из 550ти целых чисел от 1 до 50ти.

    ```javascript
    private normalizeData(filteredData: number[]) {
		const multiplier = 50 / Math.max(...filteredData);
		return filteredData.map((n: number) => ((n * multiplier) + 1).toFixed());
	}
    ```

    Итог: Данная оптимизация позволяет во много раз уменьшить объем массива, который будет храниться в базе данных по каждому семплу(аудио треку), а также подготовить целые числа для отрисовки(избегаем субпиксельного рендеринга на canvas).

    ***

2. `Webworker`.
   Цель данного этапа- отрисовка и создание png изображений по каждому загруженному треку.

    Имея массив координат, полученный на первом этапе, создаем холст при помощи технологии OffscreenCanvas и вместе с координатами отправляем postMessage в webworker. Отрисовываем данные на холсте по каждому семплу и при помощи canvas.convertToBlob() создаем изображения для отправки на сервер.

    <br/>

    ```javascript
    canvas.convertToBlob({ type: 'image/png' }).then((blob) => fileCreator(blob));

    function fileCreator(blob) {
    	const imageFile = new File([blob], 'png', { type: 'png' });

    	postMessage({ imageFile, audioFile, audioCoordinates, packId, fileId });
    }
    ```

     <br/>

    `Итог:`

   ![audio-wave](https://s157vla.storage.yandex.net/rdisk/af019d99f9fe59c0baecda35ee862b0ddc4ea8c229e5bcb65c4980d8cf37d848/61f877c1/84radWxDYTwZNdBUTS9GwiQM8dMvD5FJS3DE3cveVTBsmxMEIuknhgqut_1qS5i5ZfohRxZGjnqMvJXFzknQZQ==?uid=964945203&filename=audio-wave.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=8444&hid=56d04f2dd25cb382d6c2503e7b369f9b&media_type=image&tknv=v2&etag=5d68fd01d196152c7e66330450cbae51&rtoken=35hVyLOfTwG3&force_default=yes&ycrid=na-719d303933ce76e25e50847980662268-downloader10f&ts=5d6e9914cb240&s=8bef14a5737f86cf03004d1e549dc0dafdf913eded339d70d966d16c97655054&pb=U2FsdGVkX18Xr9Rd_bo7a_aVQQGJRRAFF7azOPHqjnstU1LltDfEI7hbifO-9Avnn1ji3tnbSb-rZyxNe51gadv07tCWSKdR5Lzcz9j0Jeg)

    Мы получаем png изображения заранее отрисованной аудио волны по каждому семплу. При загрузке странницы с семплами, нам не придется каждый раз повторять процесс вычисления и отрисовки, либо, если все же понадобиться отрисовывать на canvas, эти изображения послужат маской, которая может ставиться перед реальной отрисовкой в real time.

### `SEQUENCER PAGE`

![sequencer-page](https://s436vla.storage.yandex.net/rdisk/30a08095ec8dbc18e7defc3486adf8460cb0937d2abd3464a7ef3d84b2ac3edb/61f8728d/84radWxDYTwZNdBUTS9GwrRPlvPtQN7tCKXObubb3jDWTh5cbsESgGH5B8EeOwXigmKYMvpzLKjvs0dJMaDpIw==?uid=964945203&filename=sequencer-page.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=470236&hid=d5a30c766bd14d1ab4272d2e1a871ec3&media_type=image&tknv=v2&etag=8b05ca1825b3bfe678ce002fc588f136&rtoken=V6BCTy004Ew4&force_default=yes&ycrid=na-d222e47e6f003a9d28b89fd27c8ef6c6-downloader7f&ts=5d6e941e7fd40&s=3307376ec7e1e98e54dc5e7188ef4b0205609b8fea546dfabfc9fbc2e79d86ad&pb=U2FsdGVkX1_lxJXRdo1MEZzce74q-P1Tcxn4MuSaI4ZWf5i-tDUn9uvgNr5U3_KxJHBBdiTJhDzWCQqB-iuRxiixqish7J5O4kfxz0uNYhY)

Секвенсор - это функционал для проигрывания семплов. Он включает семпл в определенный момент времени и работает c определенной скоростью bpm. 

При включении секвенсора пользователь может переключить bpm на панели:

![bpm-controls](https://s403vla.storage.yandex.net/rdisk/afccffa006583bd1b10308990752d5726bcd7c9b19440d6907bdd27ce6de4f72/61f9511d/84radWxDYTwZNdBUTS9Gwkg9QAdO2iSgULPT5kPhnIkEE50i14ikCGzIPr9V6QnV-Z2bMxa9oQq5sFWqxROQlA==?uid=964945203&filename=bpm-controls.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=12293&hid=5bfc42f6a3fdd44ea47c6640d6630407&media_type=image&tknv=v2&etag=b3b83e274752e4a41b86885c1a3adeff&rtoken=DRlladJXL816&force_default=yes&ycrid=na-76fd7e04e2d7fa4ede1af14a777de892-downloader24f&ts=5d6f685f0c140&s=2759d1cb8cbbab2c4662c85ebc6d6e4c53a3a41eb1edf9b046d66623ad8ffc1d&pb=U2FsdGVkX1-DqW4Vcvx5bdNNVS5viIZukG65370ytMUnOSdSEFyuHbKQtSFvRVqKY34nvQWaiiTNE6Onn4SiEsmZsH79hyB3Q3UOuZs7Itk)

`Пример изменения скорости проигрывания секвенсора:`

[demo](https://disk.yandex.ru/i/_dmonx9ha0gZ2A)

Некоторые семплы представляют собой фрагмент музыки c определенной скоростью(bpm), поэтому, загружая такие семплы, нужно выставлять bpm в секвенсоре.

[demo](https://disk.yandex.ru/i/rosSYCfpDKq-Ug)

Семплы, которые пользователь отметил лайком, попадают на страницу секвенсора. Перетаскиваем семпл на любую дорожку секвенсора в зеленый бокс.

![drop-sequencer](https://s379vla.storage.yandex.net/rdisk/b28aceb649dfc3b03ce96599ecb5cabcac35fce242a30a3afb7b651ba8b3b9fe/61f95739/84radWxDYTwZNdBUTS9GwouGgPYGHjCpqy9VtHIh0TJBcaLme6suF3izr8MeTxw4CAT-tXMZzMRuahNyYiBXpA==?uid=964945203&filename=drop-sequencer.png&disposition=inline&hash=&limit=0&content_type=image%2Fpng&owner_uid=964945203&fsize=194817&hid=3a7e0e402986e864f409d63c88bfb845&media_type=image&tknv=v2&etag=033eec1414250f6a15890d786f58c18f&rtoken=uQoba8H3rFvM&force_default=yes&ycrid=na-490c2ac6721f6b593fd3cf8def16b37d-downloader20e&ts=5d6f6e3298040&s=701a9decafa76c61764794345ebd63bc84129bd9e74513497a912d4c75fc8c0a&pb=U2FsdGVkX1_Dp1aoXiTVnxbhkNn5Fnf27X4Xy0KD0C5AOqQ8LrbolNr4eYdv958-_fGBIS-am8YJJ-I4SHpb6d4hBgTSTIf-5Cj2-XKWIlk)

 и кликаем место, в котором семпл должен начинать свое проигрывание. Оно выделяется синим цветом. 

###### Секвенсор позволяет пользователю прослушать понравившиеся ему семплы в сочетании друг с другом в работе, приближенной к реальному музыкальному редактору.




